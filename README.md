# ЁЯЪА Dart Frog Chat Backend (MongoDB)

ржПржЯрж┐ ржПржХржЯрж┐ рж░рж┐ржпрж╝рзЗрж▓-ржЯрж╛ржЗржо ржЪрзНржпрж╛ржЯ ржмрзНржпрж╛ржХржПржирзНржб ржкрзНрж░рзЛржЬрзЗржХрзНржЯ ржпрж╛ **Dart Frog** ржлрзНрж░рзЗржоржУржпрж╝рж╛рж░рзНржХ ржПржмржВ **MongoDB** ржбрж╛ржЯрж╛ржмрзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржПржЯрж┐ ржорзВрж▓ржд ржлрзНрж▓рж╛ржЯрж╛рж░ ржЕрзНржпрж╛ржкрзЗрж░ рж╕рж╛ржерзЗ WebSocket ржПрж░ ржорж╛ржзрзНржпржорзЗ рзз-ржЯрзБ-рзз ржЪрзНржпрж╛ржЯ рж╣рзНржпрж╛ржирзНржбрзЗрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржбрж┐ржЬрж╛ржЗржи ржХрж░рж╛ред

---

## ЁЯЫа Features

- **WebSocket Connection:** рж░рж┐ржпрж╝рзЗрж▓-ржЯрж╛ржЗржо ржбрж╛ржЯрж╛ ржЖржжрж╛ржи-ржкрзНрж░ржжрж╛ржиред
- **1-to-1 Messaging:** ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЗржЙржЬрж╛рж░ ржЖржЗржбрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржкрзНрж░рж╛ржЗржнрзЗржЯ ржЪрзНржпрж╛ржЯред
- **Message History:** MongoDB ржерзЗржХрзЗ ржкрзБрж░ржирзЛ ржЪрзНржпрж╛ржЯ рж╣рж┐рж╕рзНржЯрзЛрж░рж┐ рж░рж┐ржЯрзНрж░рж┐ржн ржХрж░рж╛ред
- **User Joining:** рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржЗржЙржЬрж╛рж░ рж╕рзЗрж╢ржи ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯред
- **Clean Architecture:** ржбрж╛рж░рзНржЯ ржлрзНрж░ржЧ рж╕рзНржЯрж╛ржЗрж▓рзЗ рж╕рж╣ржЬ ржУ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржХрзЛржб рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ред

---

## ЁЯУе Installation & Setup

### рзз. MongoDB ржЗржирж╕рзНржЯрж▓ ржХрж░рзБржи (macOS)
ржЖржкржирж╛рж░ ржкрж┐рж╕рж┐рждрзЗ MongoDB рж╕рзНржЯрж╛рж░рзНржЯ ржХрж░рж╛ ржерж╛ржХрждрзЗ рж╣ржмрзЗ:

```bash
# MongoDB рж╕рж╛рж░рзНржнрж┐рж╕ рж╕рзНржЯрж╛рж░рзНржЯ ржХрж░рзБржи
brew services start mongodb-community@7.0
```

# рзи. ржкрзНрж░рзЛржЬрзЗржХрзНржЯ рж╕рзЗржЯржЖржк

# ржкрзНржпрж╛ржХрзЗржЬ ржЗржирж╕рзНржЯрж▓ ржХрж░рзБржи
dart pub get

# рж╕рж╛рж░рзНржнрж╛рж░ рж░рж╛ржи ржХрж░рзБржи (Default Port: 8080)
dart_frog dev



# ============ Learn (Backend Middleware) ============
рзз. ржХрж╛ржирзЗржХрж╢ржи ржЪрзЗржХ: рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржЖрж╕рж╛рж░ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ ржжрзЗржЦрж╛ рж╣ржпрж╝ MongoDB ржХрж╛ржирзЗржХрзНржЯрзЗржб ржЖржЫрзЗ ржХрж┐ ржирж╛ред ржирж╛ ржерж╛ржХрж▓рзЗ ржХрж╛ржирзЗржХрзНржЯ ржХрж░рзЗред
рзи. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ рж╕рзЗржЯржЖржк: ржбрж╛ржЯрж╛ржмрзЗржЬ ржХрж╛ржирзЗржХрж╢ржиржЯрж┐ржХрзЗ provider рж╣рж┐рж╕рзЗржмрзЗ ржкрж╛рж╕ ржХрж░рж╛ рж╣ржпрж╝, ржпрж╛рждрзЗ ржЕржирзНржп рж╕ржм рж░рзБржЯ (ржпрзЗржоржи: ржЪрзНржпрж╛ржЯ ржмрж╛ рж╣рж┐рж╕рзНржЯрзЛрж░рж┐) рж╕рж╣ржЬрзЗржЗ ржбрж╛ржЯрж╛ржмрзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗред
рзй. ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржУ рж▓ржЧрж┐ржВ: ржкрж╛ржЗржкрж▓рж╛ржЗржирзЗрж░ ржорж╛ржзрзНржпржорзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржЗржиржХрж╛ржорж┐ржВ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рж╛ рж╣ржпрж╝ред

# ============ Learn (WebSocket: Join Event) ============
рзз. ржорзЗрж╣ржорж╛ржи ржПржирзНржЯрзНрж░рж┐: ржЗржЙржЬрж╛рж░ ржХрж╛ржирзЗржХрзНржЯ рж╣рзЯрзЗ ржпржЦржи type: join ржкрж╛ржарж╛рзЯ, рж╕рж╛рж░рзНржнрж╛рж░ рждрж╛рж░ userId ржЪрж┐ржирзЗ ржирзЗрзЯред
рзи. ржбрж╛рзЯрзЗрж░рж┐рждрзЗ ржирж╛ржо рж▓рзЗржЦрж╛: рж╕рж╛рж░рзНржнрж╛рж░ ржПржХржЯрж┐ Map (ржбрж╛рзЯрзЗрж░рж┐)-ржП ржЗржЙржЬрж╛рж░рзЗрж░ ржЖржЗржбрж┐ ржПржмржВ рждрж╛рж░ рж╕ржХрзЗржЯ ржЪрзНржпрж╛ржирзЗрж▓ржЯрж┐ рж╕рзЗржн ржХрж░рзЗ рж░рж╛ржЦрзЗред
рзй. ржХржиржлрж╛рж░рзНржорзЗрж╢ржи: ржЗржЙржЬрж╛рж░ржХрзЗ ржлрж┐рж░рждрж┐ ржорзЗрж╕рзЗржЬ ржкрж╛ржарж┐рзЯрзЗ ржЬрж╛ржирж╛ржирзЛ рж╣рзЯ ржпрзЗ рж╕рзЗ рж╕ржлрж▓ржнрж╛ржмрзЗ ржЪрзНржпрж╛ржЯрзЗ ржпрзБржХрзНржд рж╣рзЯрзЗржЫрзЗред

## ============ Learn (WebSocket: Message Event) ============
рзз. ржбрж╛ржЯрж╛ ржЧрзНрж░рж╣ржг: ржЗржЙржЬрж╛рж░рзЗрж░ ржкрж╛ржарж╛ржирзЛ ржорзЗрж╕рзЗржЬ ржкрзНржпрж╛ржХрзЗржЯржЯрж┐ рж░рж┐рж╕рж┐ржн ржХрж░рзЗ ржПржмржВ рж╕рзЗржЦрж╛ржи ржерзЗржХрзЗ ржХрзЗ ржкрж╛ржарж╛ржЪрзНржЫрзЗ ржЖрж░ ржХрж╛рж░ ржХрж╛ржЫрзЗ ржпрж╛ржмрзЗ рждрж╛ ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗред
рзи. ржоржЩрзНржЧрзЛ ржоржбрзЗрж▓ (DB Save): ржорзЗрж╕рзЗржЬржЯрж┐ржХрзЗ MongoDB-рждрзЗ рж╕рзЗржн ржХрж░рж╛рж░ ржЬржирзНржп ржЖржЗржбрж┐ (_id), рж╕ржорзЯ (timestamp) ржПржмржВ ржЗржЙржирж┐ржХ ржЖржЗржбрж┐ (uuid) ржмрж╕рж┐рзЯрзЗ ржПржХржЯрж┐ ржкрзВрж░рзНржгрж╛ржЩрзНржЧ ржоржбрзЗрж▓ рждрзИрж░рж┐ ржХрж░рж╛ рж╣рзЯред
рзй. рж░рж┐рж╕рж┐ржнрж╛рж░ржХрзЗ ржЦрзЛржБржЬрж╛: ржпрж╛рж░ ржХрж╛ржЫрзЗ ржорзЗрж╕рзЗржЬржЯрж┐ ржкрж╛ржарж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ (Receiver), рж╕рзЗ ржЕржирж▓рж╛ржЗржирзЗ ржЖржЫрзЗ ржХрж┐ ржирж╛ рждрж╛ ржбрж╛рзЯрзЗрж░рж┐ (Map) ржерзЗржХрзЗ ржЪрзЗржХ ржХрж░рж╛ рж╣рзЯред
рзк. ржбрзЗрж▓рж┐ржнрж╛рж░рж┐: рж░рж┐рж╕рж┐ржнрж╛рж░ ржЕржирж▓рж╛ржЗржи ржерж╛ржХрж▓рзЗ рждрж╛ржХрзЗ ржПржмржВ ржкрзНрж░ржорж╛ржи рж╣рж┐рж╕рзЗржмрзЗ ржкрзНрж░рзЗрж░ржХржХрзЗржУ (Sender) ржорзЗрж╕рзЗржЬржЯрж┐ рждрзОржХрзНрж╖ржгрж╛рзО ржкрж╛ржарж┐рзЯрзЗ ржжрзЗржУрзЯрж╛ рж╣рзЯред

## ============ Learn (History API Flow) ============
рзз. ржорзЗржержб ржЪрзЗржХ: ржПржЯрж┐ ржПржХржЯрж┐ GET рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржХрж┐ ржирж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛ рж╣рзЯ, ржХрж╛рж░ржг рж╣рж┐рж╕рзНржЯрзЛрж░рж┐ рж╢рзБржзрзБ ржбрж╛ржЯрж╛ ржкрзЬрж╛рж░ ржЬржирзНржпред
рзи. ржбрж╛ржЯрж╛ржмрзЗржЬ рж╕рж╛рж░рзНржЪ: messages ржХрж╛рж▓рзЗржХрж╢ржи ржерзЗржХрзЗ ржУржЗ ржЗржЙржЬрж╛рж░рзЗрж░ рж╕ржм ржорзЗрж╕рзЗржЬ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛ рж╣рзЯред
рзй. рж╕рж┐рж░рж┐рзЯрж╛рж▓ ржХрж░рж╛ (Sorting): timestamp ржЕржирзБржпрж╛рзЯрзА ржорзЗрж╕рзЗржЬржЧрзБрж▓рзЛ рж╕рж╛ржЬрж╛ржирзЛ рж╣рзЯ ржпрж╛рждрзЗ ржкрзБрж░ржирзЛ ржерзЗржХрзЗ ржирждрзБржитАФ ржПржЗ ржХрзНрж░ржорзЗ ржбрж╛ржЯрж╛ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯред
рзк. рж░рзЗрж╕ржкржирзНрж╕: рж╕ржм ржорзЗрж╕рзЗржЬржХрзЗ JSON ржлрж░ржорзНржпрж╛ржЯрзЗ ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржмрж╛ ржорзЛржмрж╛ржЗрж▓ ржЕрзНржпрж╛ржкрзЗрж░ ржХрж╛ржЫрзЗ ржкрж╛ржарж┐рзЯрзЗ ржжрзЗржУрзЯрж╛ рж╣рзЯред

## ============ Learn (Active Status Logic) ============
* Registry (activeClients): ржПржЯрж┐ ржЖржкржирж╛рж░ рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ "рж╣рж╛ржЬрж┐рж░рж╛ ржЦрж╛рждрж╛"ред ржЗржЙржЬрж╛рж░ ржЖрж╕рж╛рж░ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ рждрж╛рж░ ржирж╛ржо ржПржЦрж╛ржирзЗ ржПржирзНржЯрзНрж░рж┐ рж╣рзЯред
* Routing Logic: ржорзЗрж╕рзЗржЬ ржкрж╛ржарж╛ржирзЛрж░ рж╕ржорзЯ рж╕рж╛рж░рзНржнрж╛рж░ ржПржЗ ржЦрж╛рждрж╛ ржЪрзЗржХ ржХрж░рзЗ ржжрзЗржЦрзЗ to (Receiver) ржЕржирж▓рж╛ржЗржирзЗ ржЖржЫрзЗ ржХрж┐ ржирж╛ред ржерж╛ржХрж▓рзЗ рждрж╛ржХрзЗ ржорзЗрж╕рзЗржЬржЯрж┐ ржарзЗрж▓рзЗ ржжрзЗрзЯред
* Auto-Offline: onDone ржорзЗржержбржЯрж┐ рж╕рзЗржирзНрж╕рж░рзЗрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗред ржЗржЙржЬрж╛рж░ ржЕрзНржпрж╛ржк ржмржирзНржз ржХрж░рж▓рзЗ ржмрж╛ ржирзЗржЯ ржЪрж▓рзЗ ржЧрзЗрж▓рзЗ ржПржЯрж┐ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ рж╣рж╛ржЬрж┐рж░рж╛ ржЦрж╛рждрж╛ ржерзЗржХрзЗ ржирж╛ржо ржХрзЗржЯрзЗ ржжрзЗрзЯ, ржлрж▓рзЗ /status ржПржкрж┐ржЖржЗ рждрж╛ржХрзЗ Offline ржжрзЗржЦрж╛рзЯред